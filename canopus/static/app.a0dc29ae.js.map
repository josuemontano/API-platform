{"version":3,"sources":["webpack:///./index.js","webpack:///./views/App.js","webpack:///./views/LoginForm.js","webpack:///./utils/auth.js"],"names":["__webpack_require__","_preact","root","App","default","render","h","document","body","init","class","uk-grid","_LoginForm2","googleClientID","window","windowsClientID","Component","_auth","LoginForm","props","_classCallCheck3","this","_this","_possibleConstructorReturn3","__proto__","_getPrototypeOf2","call","hello","google","windows","display","page_uri","location","href","redirect_uri","loginUserOnRedirect","authResponse","_hellojs2","getAuthResponse","authenticate","uk-margin","type","onClick","onGoogleLogin","onWindowsLogin","login","scope","force","getUserCredentials","JSON","parse","localStorage","getItem","onLogin","params","arguments","length","undefined","axios","post","network","access_token","then","response","data","user","catch","error","alert","accessToken","crendentials","id","setItem","_stringify2","storeUserCredentials"],"mappings":"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","file":"app.a0dc29ae.js","sourcesContent":["import 'babel-polyfill';\nimport 'uikit';\nimport { h, render } from 'preact';\n\nimport 'uikit/dist/css/uikit.min.css';\nimport '../css/theme.scss';\n\n\nlet root;\n\nfunction init() {\n  let App = require('./views/App').default;\n  root = render(<App />, document.body, root);\n}\n\ninit();\n\n// Re-render on Webpack HMR update:\nif (module.hot) module.hot.accept('./views/App', init);\n","import { h, Component } from 'preact';\n\nimport LoginForm from './LoginForm';\n\n\nexport default class App extends Component {\n  render() {\n    return (\n      <div class=\"starter-template\">\n        <div class=\"container\">\n          <div uk-grid>\n            <div class=\"uk-width-1-4\" />\n            <div class=\"uk-width-1-2\">\n              <div class=\"content\">\n                <h1>\n                  <span class=\"font-semi-bold\">Pyramid</span> <span class=\"smaller\">Alchemy project</span>\n                </h1>\n                <p class=\"lead\">\n                  Welcome to <span class=\"font-normal\">canopus</span>, a&nbsp;Pyramid application generated&nbsp;by<br />\n                  <span class=\"font-normal\">Cookiecutter</span>.\n                </p>\n                <LoginForm googleClientID={window.googleClientID} windowsClientID={window.windowsClientID} />\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import hello from 'hellojs';\nimport { authenticate } from '~/utils/auth';\nimport { h, Component } from 'preact';\n\n\nexport default class LoginForm extends Component {\n  constructor(props) {\n    super(props);\n\n    hello.init({\n      google: props.googleClientID,\n      windows: props.windowsClientID,\n    }, {\n      display: 'page',\n      page_uri: window.location.href,\n      redirect_uri: '/login',\n    });\n\n    this.loginUserOnRedirect();\n  }\n\n  static onGoogleLogin() {\n    const provider = hello('google');\n    provider.login({ scope: 'openid, email', force: true });\n  }\n\n  static onWindowsLogin() {\n    const provider = hello('windows');\n    provider.login({ scope: 'email', force: true });\n  }\n\n  loginUserOnRedirect() {\n    // Login user on redirection\n    let authResponse = hello('google').getAuthResponse();\n    if (!authResponse) authResponse = hello('windows').getAuthResponse();\n\n    if (authResponse) authenticate(authResponse);\n  }\n\n  render() {\n    return (\n      <p uk-margin>\n        <button type=\"button\" onClick={LoginForm.onGoogleLogin} class=\"uk-button uk-button-primary\">\n          Entrar con Google\n        </button>\n        <button type=\"button\" onClick={LoginForm.onWindowsLogin} class=\"uk-button uk-button-secondary\">\n          Entrar con Microsoft\n        </button>\n      </p>\n    );\n  }\n}\n","import axios from 'axios';\n\n\nfunction storeUserCredentials(user, accessToken) {\n  const crendentials = {\n    id: user.id,\n    access_token: accessToken,\n  };\n  localStorage.setItem('user', JSON.stringify(crendentials));\n}\n\nexport function getUserCredentials() {\n  return JSON.parse(localStorage.getItem('user')) || {};\n}\n\nexport function onLogin(user, accessToken) {\n  storeUserCredentials(user, accessToken);\n  window.location = '/';\n}\n\nexport function authenticate(params = {}) {\n  axios\n    .post(`/auth/${params.network}`, { access_token: params.access_token })\n    .then(response => response.data)\n    .then(response => onLogin(response.user, response.access_token))\n    .catch((error) => {\n      alert('User could not login');\n    });\n}\n"],"sourceRoot":""}